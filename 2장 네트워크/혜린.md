# 2장 네트워크

## 2.1 네트워크의 기초

> 네트워크란 **노드(node)**와  **링크(link)**가 서로 연결되어 있거나 연결되어 있지 않은 집합체이다.
> 

여기서 노드란 서버, 라우터, 스위치 등 네트워크 장치를 의미하고 링크는 유선 또는 무선을 의미한다.

### 2.1.1 처리량과 지연 시간

**처리량(throughput)**

- 링크를 통해 전달되는 단위 시간당 데이터양을 말한다.
- 단위는 bps(bits per second)이며, 초당 전송 또는 수신되는 비트 수를 뜻한다.
- 트래픽, 네트워크 장치 간의 대역폭, 네트워크 중간에 발생하는 에러, 장치의 하드웨어 스펙에 영향을 받는다.

여기서 **대역폭**이란 주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수를 말한다.

**지연 시간(latency)**

- 요청이 처리되는 시간을 말하며 어떤 메시지가 두 장치 사이를 왕복하는 데 걸린 시간을 말한다.
- 매체 타입(무선, 유선), 패킷 크기, 라우터의 패킷 처리 시간에 영향을 받는다.

❓ 패킷 (**pack + bucket)**

우체국에서는 화물을 적당한 덩어리로 나눠 행선지를 표시하는 꼬리표를 붙이는데 이러한 방식을 데이터 통신에 접목한 것이다.

즉, **정보를 보낼 때 특정 형태에 맞추어 보낸다는 것**! 

컴퓨터 간에 데이터를 주고받을 때 네트워크를 통해서 전송되는 **데이터 조각**이라고 생각하면 편함

*그렇다면 데이터를 한 번에 통으로 보내는 것이 더 편하지 않을까?*

더 빠르고 좋겠지만 큰 데이터는 **대역폭 (**신호를 전송할 수 있는 주파수 범위 또는 폭)을 너무 많이 차지하기 때문에 패킷의 흐름을 원활하게 하지 못한다. (트래픽이 많아짐) 

큰 사진 하나를 상대에게 보낸가고 가정해보자. 

큰 사진은 작은 패킷들로 분할된 뒤, 상대방에게 전달될 때 번호를 붙여서 전달된다. 그래야지 순서대로 나열했을 때 원하는 사진을 볼 수 있다. 

이러한 교환 방식을 **패킷 교환 방식**이라고 한다.

- 패킷의 구조

![스크린샷 2024-08-05 160016.png](2%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20b8d2d903f72f4c8ebf6b7cb2f4666ca7/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2024-08-05_160016.png)

IP 패킷은 헤더로 정의되며 해당 헤더에는 많은 필드가 포함된다. 

헤더의 주요 요소는 다음과 같다.

- 버전
- TTL (Time to Live)
- 프로토콜
- 헤더 체크섬
- 소스 주소
- 대상 주소
- 데이터

패킷에 대해 좀더 깊게 설명하자면 패킷에서는 Preamble 정보, SFD, FCS, IFG 등 비트열을 붙여서 전송된다.

(나중에 나올 링크 계층에서는 패킷을 **프레임**이라는 용어로 표한한다. 또한 **헤더와 프레임 트레일러를 포함**하고 있다.)

### 2.1.2 네트워크 토폴로지와 병목 현상

**네트워크 토폴로지**

노드와 링크가 어떻게 배치되어 있는지에 대한 방식이자 연결 형태를 의미한다.

1. 트리 토폴로지(계층형 토폴로지)
    - 트리 형태로 배치한 네트워크 구성이다.
    - 노드 추가, 삭제가 쉬우며 특정 노드에 트래픽이 집중될 때 하위 노드에 영향을 끼칠 수 있다.
    
2. 버스 토폴로지
    - 중앙 통신 회선 하나에 여러 개의 노드가 연결되어 공유하는 네트워크 구성을 말한다.
    - 근거리 통신망(LAN)에서 사용한다.
    - 설치 비용이 적고 회선에 노드 추가, 삭제가 쉬운 반면 스푸핑이 가능한 문제점이 있다.

스푸핑이란 LAN 상에서 송신부의 패킷을 송신과 관련 없는 다른 호스트에게 가지 않도록 하는 스위칭 기능을 마비시키거나 속여서 특정 노드에 해당 패킷이 오도록 처리하는 것을 말한다. 

따라서 스푸핑 적용시 수신부로 가야할 패킷이 악의적인 노드에 전달된다. 

1. 스타 토폴로지
    - 중앙에 있는 노드에 모두 연결된 네트워크 구성을 말한다.
    - 노드 추가나 에러 탐지가 쉽고 패킷 충돌 발생 가능성이 적다.
    - 그러나 중앙 노드에 장애 발생시 전체 네트워크를 사용할 수 없고 설치 비용이 고가이다.

1. 링형 토폴로지
    - 각각의 노드가 양 옆의 두 노드와 연결하여 전체적으로 고리처럼 하나의 연속된 길을 통해 통신을 하는 망 구성 방식이다.
    - 데이터는 노드에서 노드로 이동하며 고리 모양의 길을 통해 패킷을 처리한다.
    - 노드 수가 증가되어도 네트워크 상의 손실이 거의 없고 충돌 발생 가능성이 적으며 노드 고장 발견이 쉽다.
    - 하지만 네트워크 구성 변경이 어렵고 회선 장애 발생시 전체 네트워크에 영향을 끼친다.
    
2. 메시 토폴로지(망형 토폴로지)
    - 그물망처럼 연결되어 있는 구조이다.
    - 한 단망 장치에 장애가 발생해도 여러 개의 경로가 존재하므로 네트워크를 계속 사용할 수 있고 트래픽 분산 처리도 가능하다.
    - 하지만 노드 추가가 어렵고 구축, 운영 비용이 고가이다.

**병목 현상**

> 병목 현상은 전체 시스템의 성능이나 용량이 하나의 구성 요소로 인해 제한을 받는 현상을 말한다.
> 

토폴로지가 중요한 이유는 병목현상을 찾을 때 중요한 기준이 되기 때문이다.

### 2.1.3 네트워크 분류

1. **LAN**(Local Area Network): 근거리 통신망이다. 전송 속도가 빠르고 혼잡하지 않다.
2. **MAN**(Metropolitan Area Network): 대도시 지역 네트워크를 나타낸다. 전송 속도는 평균이며 LAN보다는 더 혼잡하다.
3. **WAN**(Wide Area Network): 광역 네트워크를 의미한다. 전송 속도는 낮으며 MAN보다 더 혼잡하다.

### 2.1.4 네트워크 성능 분석 명령어

네트워크 병목 현상의 원인은 아래와 같다.

1. 네트워크 대역폭
2. 네트워크 토폴로지
3. 서버 CPU, 메모리 사용량
4. 비효율적인 네트워크 구성

이 경우 네트워크 관련 테스트와 네트워크와 무관한 테스트를 통해 ‘네트워크로부터 발생한 문제점’인 것을 확인한 후 네트워크 성능 분석을 해야 한다.

**ping**

- 네트워크 상태를 확인하려는 대상 노드를 향해 일정 크기의 패킷을 전송하는 명령어이다.
- 해당 노드의 패킷 수신 상태
- 도달하기까지의 시간
- 해당 노드까지 네트워크가 잘 연결되어 있는지 확인할 수 있다.
- TCP/IP 프로토콜 중에 ICMP 프로토콜을 동해 동작한다. 따라서 ICMP 프로토콜을 지원하지 않는 기기를 대상으로는 실행할 수 없거나 네트워크 정책상 ICMP나 traceroute를 차단하는 대상의 경우 ping 테스팅은 불가능하다.

**netstat**

- 접속되어 있는 서비스들의 네트워크 상태를 표시하는 데 사용
- 네트워크 접속, 라우팅 테이블, 네트워크 프로토콜 등 리스트를 보여준다.
- 주로 서비스의 포트가 열려 있는지 확인할 때 쓴다.

**nslookup**

- DNS에 관련된 네용을 확인하기 위해 쓰는 명령어이다.
- 특정 도메인에 매핑된 IP를 확인하기 위해 사용한다.

**tracert**

- 목적지 노드까지 네트워크 경로를 확인할 때 사용하는 명령어이다.
- 어느 구간에서 응답 시간이 느려지는지 등을 확인할 수 있다.

### 2.1.5 네트워크 프로토콜 표준화

> 네트워크 프로토콜이란 다른 장치들끼리 데이터를 주고받기 위해 설정된 공통된 인터페이스를 말한다.
> 

IEEE 또는 IETE라는 표준화 단체가 이를 정한다.

## 2.2 TCP/IP 4계층 모델

### 2.2.1 계층 구조

1. TCP/IP 4 계층
    - 애플리케이션 계층
    - 전송 계층
    - 인터넷 계층
    - 링크 계층
    

1. OSI 7계층
    - 애플리케이션 계층 (애플리케이션 계층)
    - 프레젠테이션 계층 (애플리케이션 계층)
    - 세션 계층 (애플리케이션 계층)
    - 전송 계층 (전송 계층)
    - **네트워크 계층 (**인터넷 계층**)**
    - 데이터 링크 계층 (링크 계층)
    - 물리 계층 (링크 계층)
    

TCP/IP 계층과 달리 OSI 계층은 애플리케이션 계층을 세 개로 쪼갠다. 또한 링크 계층을 데이터 링크 계층, 물리 계층으로 나눠서 표현한다. 마지막으로 인터넷 계층을 네트워크 계층으로 부른다.

1. 애플리케이션 계층

> FTP, HTTP, SSH, SMTP, DNS 등 응용 프로그램이 사용되는 프로토콜 계층이며 웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층이다.
> 
- **FTP**

장치와 장치간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜

- **SSH**

보안되지 않은 네트워크에서 네트워크 서비스를 안전하게 운영하기 위한 암호화 네트워크 프로토콜

- **HTTP**

World Wide Web을 위한 데이터 통신의 기초이자 웹 사이트를 이용하는 데 쓰는 프로토콜

- **SMTP**

전자 메일 전송을 위한 인터넷 표준 통신 프로토콜

- **DNS**

도메인 이름과 IP 주소를 매핑해주는 서버.

1. 전송 계층

> 송신자와 수신자를 연결하는 통신 서비스를 제공하며 연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어를 제공한다. 또한 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 때의 중계 역할을 한다.

대표적으로 **TCP, UDP**가 있다.
> 

 

- **TCP**는 패킷 사이의 순서를 보장하고 연결지향 프로토콜을 사용해서 연결을 하여 신뢰성을 구축해서 수신 여부를 확인하며 ‘가상 회신 패킷 교환 방식’을 사용한다.

**가상 회신 패킷 교환 방식**

각 패킷에는 가상회선 식별자가 포함되며 모든 패킷을 전송하면 가상회선이 해제되고 패킷들은 전송된 ‘**순서대로**’ 도착하는 방식을 말한다.

- **UDP**는 순서를 보장하지 않고 수신 여부를 확인하지 않으며 단순히 데이터만 주는 ‘데이터그램 패킷 교환 방식’을 사용한다.

**데이터그램 패킷 교환 방식**

패킷은 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송될 수 있으며 도착한 ‘**순서가 다를 수**’ 있는 방식을 말한다.

**TCP 연결 성립 과정**

TCP는 신뢰성을 확보할 때 ‘**3-웨이 핸드셰이크**(3-way handshake)’라는 작업을 진행한다.

❓ **핸드셰이크**란 통신에서 연결을 설정하기 위한 과정이며, 두 통신 장치 간 데이터 교환 규칙, 속도, 보안 설정 등의 파라미터를 협상한다.

핸드셰이크라는 명칭이 붙는 대표적인 유형들을 몇 가지 있다. 결론은 각 통신 프로토콜들의 통신 방식을 000 핸드셰이크라는 식으로 표현한다는 것이다.

**1. TCP 3-way Handshake**

TCP(Transmission Control Protocol)에서는 **3-way handshake** 과정을 통해 연결을 설정한다. 총 3단계의 과정이 있다는 점이 특징이라 3-way handshake라고 부른다.

- **SYN** : 클라이언트가 서버에 연결 요청을 보낸다.
- **SYN-ACK** : 서버가 연결 요청을 확인하고 클라이언트에 응답한다.
- **ACK** : 클라이언트가 서버의 응답을 확인하고 연결이 설정된다.

**2. SSL/TLS Handshake**

클라이언트와 서버 간의 암호화된 연결을 설정하는 과정이다. SSL(Secure 
Sockets Layer) 및 TLS(Transport Layer Security)에서는 보안 파라미터 및 암호화 키를 협상하는 핸드셰이크 과정을 진행한다.

- 클라이언트 헬로 : 클라이언트가 서버에 연결 요청을 보내고 사용 가능한 암호 스위트(암호화 알고리즘 및 키 교환 방법의 조합) 및 TLS 버전을 제안한다.
- 서버 헬로 : 서버가 클라이언트의 제안 중에서 선택한 암호 스위트 및 TLS 버전을 응답하고 인증서를 제공한다.
- 클라이언트 키 교환 : 클라이언트가 서버의 인증서를 검증하고 세션 키를 생성한 후 서버에게 전달한다.
- 핸드셰이크 완료 : 클라이언트와 서버가 암호화된 통신을 시작한다.

**3. WebSocket Handshake**

WebSocket 프로토콜은 HTTP 기반의 핸드셰이크를 사용하여 초기 연결을 설정한다.

- 클라이언트는 웹 서버에 HTTP 요청을 보내고, Upgrade 헤더를 포함해서 WebSocket 연결로 전환하고자 함을 나타낸다.
- 서버는 클라이언트의 요청을 확인하고, 101 Switching Protocols 응답을 반환해서 WebSocket 연결을 수락한다.
- 이 과정이 완료되면 클라이언트와 서버는 WebSocket 프로토콜을 사용하여 양방향 통신을 시작할 수 있다.

3-웨이 핸드셰이크 과정 이후 신뢰성이 구축되고 데이터 전송을 시작한다.

참고로 **TCP**는 이 과정이 있기 때문에 **신뢰성 있는 계층**이라고 하며 **UDP**는 이 과정이 없기 때문에 **신뢰성 없는 계층**이라고 한다.

**TCP 연결 해제 과정**

연결 해제시에는 **4-웨이 핸드셰이크** 과정이 발생한다.

- **FIN**: "Finish"
    - 연결을 종료하고자 할 때 사용됩니다.
    - 한 쪽이 더 이상 데이터를 보낼 것이 없음을 나타냅니다
- **ACK**: "Acknowledgment"
    - 수신 측이 패킷을 잘 받았음을 알리는 데 사용됩니다.
    - 이전에 받은 데이터나 요청에 대한 확인 응답을 나타냅니다.
    

**[step 1] : 클라이언트 ———(FIN)———> 서버**

- **클라이언트**가 **서버**에게 연결 종료를 요청하는 **FIN 세그먼트**를 보낸다.
- 이때 FIN 패킷에는 실질적으로 ACK도 포함되어있다.
- **클라이언트**는 전송 후 **FIN-WAIT-1** 상태가 된다.

**[step 2] : 클라이언트 <———(ACK)——— 서버**

- **서버**는 **FIN을 받고**, 확인했다는 **ACK를 클라이언트에게 보내**고 자신의 통신이 끝날때까지 기다린다.
- 아직 남은 데이터가 있다면 마저 **전송을 마친 후에 close( )를 호출**한다. (**CLOSE_WAIT 상태**)
- **클라이언트**는 ACK를 받은 후에 **서버**가 남은 데이터 처리를 끝내고 **FIN 패킷을 보낼 때까지 기다린다**. (**FIN_WAIT_2 상태)**

**[step 3] : 클라이언트 <———(FIN)——— 서버**

- **서버**가 데이터를 모두 보냈다면, 연결 종료에 합의 한다는 의미로 **FIN 패킷을 클라이언트에게 보낸다**.
- 이후 ACK를 받을때까지 기다리는 **LAST_ACK** **상태**가 된다.

**[step 4] : 클라이언트 ———(ACK)———> 서버**

- **클라이언트**는 FIN을 받고, 응답 ACK를 서버에게 보낸다.
- 아직 **서버**로부터 받지 못한 데이터가 있을 수 있으므로 **TIME_WAIT을 통해 기다린다.**
    - **TIME_WAIT** 이 존재하는 이유는
        - 지연 패킷이 발생할 경우를 대비하기 위해
        - 의도치 않은 에러로 인해 연결이 **데드락**으로 빠지는 것을 방지하기 위해 존재한다.

[**after]**

- **서버**는 ACK를 받은 이후 소켓을 닫는다 (**Closed**)
- TIME_WAIT 시간이 끝나면 **클라이언트**도 소켓을 닫는다 (**Closed**)

❓ 데드락

운영체제에서 데드락(교착상태)이란, **시스템 자원에 대한 요구가 뒤엉킨 상태**를 말한다.

즉, **둘 이상의 프로세스가 다른 프로세스가 점유하고 있는 자원을 서로 기다릴 때 무한 대기에 빠지는 상황**을 일컫는다.

4 Way Handshake는 3 Way Handshake처럼 순차적 방식이 아니라 상대방이 응답을 줄 때까지 대기하는 과정이 포함되어서 서로 대기만 하는 데드락(교착) 상태에 빠질 수 있다.

❓ 데이터 무결성
데이터의 **정확성, 일관성, 유효성이 유지되는 것**을 의미한다.

1. 인터넷 계층

> 장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 **목적지로 전송**하기 위해 사용되는 계층
> 
- IP, ARP, ICMP 등이 있으며 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달한다.
- 상대방이 제대로 받았는지에 대해 보장하지 않는 비연결형적인 특징이 있다.

1. 링크 계층

> 전선, 광섬유, 무선 등으로 실질적으로 데이터를 전달하며 **장치 간에 신호를 주고받는 ‘규칙’**을 정하는 계층이다. 네트워크 접근 계층이라고도 한다.
> 
- 물리 계층, 데이터 링크 계층 둘로 나뉘기도 한다.
    - **물리 계층**
        - 무선 LAN과 유선 LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층
        - 케이블 등의 데이터 신호를 담는 하드웨어 매개체
    - **데이터 링크 계층**
        - 물리 계층만 있다면 네트워크 기기간에 데이터 전송시 엄청난 비효율이 발생한다. ex. 원하는 목적지로 전송 할 수 없어서 모든 곳에 동시에 전송하게 됨, 많은 케이블로 각각의 기기를 모두 연결해야 함
        - **‘이더넷 프레임’**을 통해 에러 확인, 흐름 제어, 접근 제어를 담당하는 계층
        

❓ 이더넷이란

LAN (근거리 통신망) 구축을 위해 장치를 연결하는 데 널리 사용되는 네트워킹 프로토콜이다. 장치가 네트워크를 통해 데이터 패킷을 다른 장치와 교환하여 통신하도록 지원한다.

- 용도
    - 장치 연결
    - 파일 공유
    - 화상 회의
    - 온라인 게이밍
    
- 이더넷 프레임의 구조
    - **Preamble**: 이더넷 프레임의 시작을 알린다
    - **SFD(Start Frame Delimiter)**: 다음 바이트부터 MAC 주소 필드가 시작됨을 알린다.
    - **DMAC, SMAC**: 수신, 송신 MAC 주소를 말한다.
        - MAC 주소
            - 컴퓨터나 노트북 등 각 장치에는 네트워크에 연결하기 위한 장치(LAN 카드)가 있는데, 이를 구별하기 위한 식별번호
            - 6바이트(48비트)로 구성된다.
    - **EtherType**: 데이터 계층 위의 계층인 IP 프로토콜을 정의한다. 예를 들어 IPv4 또는 IPv6가 된다.
    - **Payload**: 전달받은 데이터
    - **CRC**: 에러 확인 비트

**유선 LAN(IEEE802.3)**

유선 LAN을 이루는 이더넷은 IEEE802.3이라는 프로토콜을 따르며 **전이중화 통신(Full Duplex)**을 쓴다.

- 전이중화 통신
    - 양쪽 장치가 동시에 송수신할 수 있는 방식
    - **송신로**와 **수신로**로 나눠서 데이터를 주고받음
    - 현대의 고속 이더넷은 이 방식을 기반으로 통신함

- CSMA/CD
    - 이전에는 **반이중화 통신(Half Duplex)** 중 하나인 CSMA/CD 방식을 썼다. CSMA/CD는 **충돌이 발생하는 경우 일정 시간 이후 재전송 하는 방식**을 말한다.
    - 수신로와 송신로를 각각 둔 것이 아니라 **한 경로를 기반**으로 데이터를 보내기 때문에 데이터를 보낼 때 충돌에 대해 대비해야 했기 때문이다.

**유선 LAN을 이루는 케이블**

- 트위스트 페어 케이블(TP 케이블)
    - UTP(=LAN 케이블)와 STP로 나뉜다.
    - UTP(=LAN 케이블)를 꽂을 수 있는 커넥터를 RJ-45 커넥터라고 한다.
- 광섬유 케이블
    - 장거리 및 고속 통신 가능

**무선 LAN(IEEE802.11)**

수신과 송신에 같은 채널을 사용하기 때문에 **반이중화 통신(Half Duplex)**을 사용한다.

❓ 반이중화 통신과 전이중화 통신

- 반이중화 통신**(Half Duplex)**
    - 송신과 수신을 양쪽 장치에서 할 수 있지만 동시에는 불가하다.
    - 동시에 전송하면 충돌 발생하기 때문에 **방지 시스템**이 필요하다.
    - ex. 휴대용 무선 통신기와 인터넷 폰이 대표적이다. 통화하는 두 사람 중 반드시 한 사람만 얘기 가능. 한 쪽 말이 끝나면 이 사실을 상대에게 알려주어야 상대가 말할 수 있음
- 전이중화 통신**(Full Duplex)**
    - 양쪽 장치는 같은 시간의 매체상에서 송신과 수신을 할 수 있다.

- CSMA/CA
    - 반 이중화 통신 중 하나이다. **충돌 방지 과정**은 다음과 같다.
    1. 데이터 송신 전 무선 매체를 살핀다.
    2. **캐리어 감지**: 회선이 비어 있는지를 판단한다.
    3. IFS(Inter FrameSpace): 랜덤 값을 기반으로 정해진 시간만큼 기다리며, 만약 무선 매체가 사용 중이면 점차 그 간격을 늘려가며 기다린다.
    4. 이후에 데이터를 송신한다.

**무선 LAN을 이루는 주파수**

무선 LAN은 무선 신호 전달 방식을 이요하여 2대 이상의 장치를 연결하는 기술이다.

- 비유도 매체인 공기에 주파수를 쏘아 무선 통신망을 구축
- 주파수 대역은 2.4 GHz 대역 또는 5GHz 대역 중 하나를 써서 구축. 보통 후자를 사용하는 게 좋음

- 와이파이 (공유기)
    - 전자기기들이 무선 LAN 신호에 연결할 수 있게 하는 기술
    - 무선 접속 장치(AP, Access Point)를 통해 유선 LAN에 흐르는 신호를 무선 LAN 신호로 바꿔주어 사용한다.
    - 무선 LAN 을 이용한 기술은 지그비, 블루투스 등이 있다.

❓ 무선 접속 장치(AP, Access Point)

와이파이 표준을 이용하여 무선 장치들을 유선 장치에 연결할 수 있게 하는 장치를 가리킨다.

- BSS (Basic Service Set)
    - 기본 서비스 집합을 의미한다.
    - 단순 공유기를 통해 네트워크를 접속하게 아니라 동일 BSS 내에 있는 AP 들과 장치들이 서로 통신이 가능한 구조를 말한다.
    - 근거리 무선 통신을 제공하고, 하나의 AP만을 기반으로 구축되어 있어 사용자가 한 곳에서 다른 곳으로 자유롭게 이동하며 네트워크에 접속하는 것은 불가하다.

- ESS (Extended Service Set)
    - 하나 이상의 연결된 BSS 그룹이다.
    - 장거리 무선 통신을 제공하고, 더 많은 가용성과 이동성을 지원한다. 따라서 사용자는 한 장소에서 다른 장소로 이동하며 중단 없이 네트워크에 계속 연결할 수 있다.

**계층 간 데이터 송수신 과정**

애플리케이션 계층 → 전송 계층(캡슐화) → 인터넷 계층 → 링크 계층 → 인터넷 계층 → … →애플리 케이션 계층(비캡슐화)

- 캡슐화 과정
    - 상위 계층의 헤더와 데이터를 하위 계층의 데이터 부분에 포함시키고 해당 계층의 헤더를 삽입하는 과정
    - 애플리케이션 계층의 데이터가 전송 계층으로 전달되면서 **‘세그먼트’ 또는 ‘데이터그램’** 화 되며 TCP(L4) 헤더가 붙여지게 된다.
    - 이후 인터넷 계층으로 가면서 IP(L3) 헤더가 붙여지게 되며 **‘패킷’**화가 된다.
    - 이후 링크 계층으로 전달되면서 프레임 헤더와 프레임 트레일러가 붙어 **‘프레임’** 화가 된다.
- 비캡슐화 과정
    - 하위 계층에서 상위 계층으로 가며 각 계층의 헤더 부분을 제거하는 과정
    - 링크 계층에서부터 프레임화 된 데이터는 다시 패킷화를 거쳐 세그먼트, 데이터 그램화, 메시지화가 되는 비캡슐화 과정이 일어난다.
    - 최종적으로는 사용자에게 애플리케이션의 PDU인 메시지로 전달된다.

### 2.2.2 PDU

> 네트워크의 어떠한 계층에서 계층으로 데이터가 전달될 때 한 덩어리의 단위를 PDU (Protocol Data Unit)라고 한다.
> 

PDU는 헤더(제어 관련 정보), 페이로드(데이터)로 구성되어 있으며 계층마다 부르는 명칭이 다르다.

- **애플리케이션 계층**: 메시지
- **전송 계층**: 세그먼트(TCP), 데이터그램(UDP)
- **인터넷 계층**: 패킷
- **링크 계층**: 프레임(데이터 링크 계층), 비트(물리적 계층)

예시로 애플리케이션 계층은 메시지를 기반으로 데이터를 전달하며, HTTP 헤더가 문자열인 것을 예로 들 수 있다.

참고로 PDU 중 비트(물리적 계층)으로 송수신하는 것이 모든 PDU 중 가장 빠르고 효율성이 높다. 그러나 애플리케이션 계층에서는 문자열을 기반으로 송수신을 하는데, 그 이유는 헤더에 authorization 값 등 가른 값들을 넣는 확장이 쉽기 때문이다.

## 2.2 네트워크 기기

### 2.3.1 네트워크 기기의 처리 범위

상위 계층을 처리하는 기기는 하위 계층을 처리할 수 있지만 그 반대는 불가하다.

- **애플리케이션 계층**: L7 스위치
- **인터넷 계층**: 라우터, L3 스위치
- **데이터 링크 계층**: L2 스위치, 브리지
- **물리 계층**: NIC, 리피터, AP

예를 들어 L7 스위치는 애플리케이션 계층을 처리하는 기기로, 그 밑의 모든 계층의 프로토콜을 처리할 수 있다. 반면 AP는 물리 계층만 처리 할 수 있다.

❓ 스위치

- 여러 장비를 연결
- 데이터 통신을 중재
- 목적지가 연결된 포트로만 전기 신호를 보내 데이터를 전송하는 통신 네트워크 장비

### 2.3.2 애플리케이션 계층을 처리하는 기기

**L7 스위치 (로드 밸런서)**

- 서버의 부하를 분산하는 기기이다.
- 목표
    - 클라이언트로부터 오는 요청들을 뒤쪽의 여러 서버로 나누는 역할을 하며 시스템이 처리할 수 있는 트래픽 증가
- 특징
    - URL, 서버, 캐시, 쿠키들을 기반으로 트래픽을 분산
    - 바이러스, 불필요한 외부 데이터 등을 걸러내는 필터링 기능
    - 응용 프로그램 수준의 트래픽 모니터링 가능
- 장애 발생시
    - 정기적으로 헬스 체크(health check)를 이용해서 감시

❓ 로드밸런서

로드밸런서(Load Balancer)는 클라이언트와 서버 그룹 사이에 위치해 서버에 가해지는 트래픽을 여러 대의 서버에 고르게 분배하여 특정 서버의 부하를 덜어준다.

**L4 스위치와 L7 스위치의 차이**

- L4 스위치
    - 인터넷 계층을 처리하는 기기로 스트리밍 관련 서비스에서 사용 불가하다.
    - 메시지를 기반으로 인식하지 못하고 IP와 포트를 기반으로(특히 포트를 기반으로) 트래픽을 분산한다.
- L7 스위치
    - IP, 포트 외에도 URL, HTTP 헤더, 쿠키 등을 기반으로 트래픽을 분산한다.

참고로 클라우드 서비스(AWS 등)에서 L7 스위치를 이용한 로드밸런싱은 ALB(Application Load Balancer) 컴포넌트로 하며, L4 스위치를 이용한 로드밸런싱은 NLB (Network Load Balancer) 컴포넌트로 한다.

**헬스 체크**

- 전송 주기와 재전송 횟수 등을 설정한 이후 반복적으로 서버에 요청을 보내는 것을 말한다.
- 서버에 부하가 되지 않을 만큼 요청 횟수가 적절해야 한다.
- TCP, HTTP 등 다양한 방법으로 요청을 보내어 요청이 정상적으로 이뤄진다면 정상적인 서버로 판별한다.
- ex. TCP 요청을 보냈는데 3-웨이 핸드셰이크가 정상적으로 일어나지 않았다면 정상이 아님

**로드 밸런서를 이용한 서버 이중화**

- 서버 이중화는 로드 밸런서의 대표기능
- 로드 밸런서는 2대 이상의 서버를 기반으로 서비스 제공
    - 안정적 서버 운용의 조건은 2대 이상의 서버 (1대가 에러나도 나머지 1대가 안정적으로 운용되어야 함)

### 2.3.3 인터넷 계층을 처리하는 기기

**라우터(router)**

- 여러 개의 네트워크를 연결, 분할, 구분시켜주는 역할
- **다른 네트워크에 존재하는 장치끼리 서로 데이터를 주고받을 때 패킷 소모를 최소화하고 경로를 최적화하여 최소 경로 패킷을 포워딩**하는 라우팅 장비
- 소프트웨어 기반의 라우팅과 하드웨어 기반의 라우팅(담당장치는 L3)으로 나뉜다.

**L3 스위치(=라우터)**

- L2 스위치의 기능과 라우팅 기능을 갖춘 장비를 말한다.

### 2.3.4 데이터 링크 계층을 처리하는 기기

**L2 스위치**

- 장치들의 MAC 주소를 MAC 주소 테이블을 통해 관리하며, 연결된 장치로부터 패킷이 왔을 때 패킷 전송을 담당한다.
- IP 주소를 이해하지 못해서 단순히 MAC 주소를 읽어 스위칭하는 역할을 한다.

❓ MAC(Media Access Control) 주소

통신할 하드웨어 장비를 식별할 수 있는 고유 주소

이더넷은 이더넷 인터페이스 간에 데이터를 전송한다. 데이터를 전송하려면 이더넷 인터페이스를 특정해야 하며, 이더넷 인터페이스를 특정하기 위해 MAC 주소가 필요하다.

❓ IP 주소와의 차이?

IP 주소도 통신을 하기 위해 사용되는 주소는 맞음. 그러나 IP 주소만 가지고 통신을 할 수 있진 않다. **IP(IP Address)와 맥 어드레스(MAC Address) 둘 다 필요**하다.

IP 주소만을 가지고 통신을 시도하는 것처럼 보이지만 **실제로 마지막에 맥 어드레스가 필요**하다. 이는 TCP/IP 4 계층과 OSI 7 계층이라는 통신표준에서 설계되어 있는대로 통신이 진행되기 때문이다.

IP 주소는 Layer 3 **네트워크 계층**에서 사용되고 맥 주소는 Layer 2 **데이터 링크 계층**에서 사용되는 주소다. 통신 표준에 맞게 단계별로 진행될 때, IP 주소에서 맥 주소로 변환되는 과정을 거치는데 이를 **ARP**(Address Resolution Protocol)이라고 한다.

**브리지**

- 두 개의 근거리 통신망(LAN)을 상호 접속할 수 있도록 하는 통신망 연결 장치
- 포트와 포트 사이의 다리 역할을 한다.
- 장치에서 받아온 MAC 주소를 MAC 주소 테이블로 관리한다.
- 통신망 범위를 확장하고 서로 다른 LAN 등으로 이루어진 ‘하나의’ 통신망을 구축할 때 쓰인다.

### 2.3.5 물리 계층을 처리하는 기기

**NIC (Network Interface Card, LAN 카드)**

- 2대 이상의 컴퓨터 네트워크를 구성하는 데 사용하며, 네트워크와 빠른 속도로 데이터를 송수신 할 수 있도록 컴퓨터 내에 설치하는 확장 카드
- 각 LAN 카드에는 고유 식별 번호인 MAC 주소가 있다.

**리피터 (repeater)**

- 들어오는 약해진 신호 정도를 증폭하여 다른 쪽으로 전달하는 장치
- 따라서 패킷이 더 멀리 갈 수 있다. 그러나 광케이블이 보급됨에 따라 현재는 잘 쓰이지 않는다.

**AP (Access Point)**

- 패킷을 복사하는 기기
- AP에 유선 LAN을 연결한 후 다른 장치에서 무선 LAN 기술 (와이파이 등)을 사용하여 무선 네트워크을 연결 할 수 있다.

## 2.4 IP 주소

### 2.4.1 ARP

> IP 주소로부터 MAC 주소를 구하는 IP와 MAC 주소의 다리 역할을 하는 프로토콜
> 

IP 주소를 MAC 주소로 변환한다. 반대로 RARP를 통해 실제 주소인 MAC 주소를 가상 주소인 IP 주소로 변환하기도 한다.

ARP Request 브로드캐스트를 보내서 IP 주소에 해당하는 MAC 주소를 찾는다. 이후 ARP reply 유니캐스트를 통해 MAC 주소를 찾는다.

- 브로드캐스트: 송신 호스트가 전송한 데이터가 네트워크에 연결된 모든 호스트에 전송되는 방식
- 유니캐스트: 고유 주소로 식별된 하나의 네트워크 목적지에 1:1로 데이터를 전송하는 방식

### 2.4.2 홉바이홉 통신

> IP 주소를 통해 통신하는 과정
> 

수많은 서브 네트워크 속에서 라우터에 있는 라우팅 테이블의 IP를 기반으로 패킷을 전달하고 또 전달해나가며 라우팅을 수행하며 최종 목적지까지 패킷을 전달한다.

즉, 통신 장치에 있는 라우팅 테이블의 IP를 통해 시작 주소부터 시작하여 다음 IP로 계속해서 이동하는 라우팅 과정을 거쳐 패킷이 최종 목적지까지 도달하는 통신을 말한다.

- 라우팅: IP 주소를 찾아가는 과정

라우팅 테이블이란

- 송신지에서 수신지까지 도달하기 위해 사용된다.
- 라우터에 들어가 있는 목적지 정보들과 그 목적지로 가기 위한 방법이 들어있는 리스트이다.
- 게이트 웨이와 모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야 할 다음 라우터의 정보를 가지고 있다.

**게이트웨이**

> 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어를 일컫는 용어
> 

사용자는 인터넷에 접속하기 위해 수많은 톨게이트인 게이트웨이를 거쳐야 하며 게이트웨이는 서로 다른 네트워크상의 통신 프로토콜을 변환해주는 역할을 하기도 한다.

게이트웨이를 확인하는 방법은 라우팅 테이블을 통해 볼 수 있으며 라우팅 테이블은 윈도우 명령 프롬프트에서 $ netstat -r 명령어를 실행하여 확인할 수 있다.

### 2.4.3 IP 주소 체계

IP 주소는 **IPv4**와 **IPv6**로 나뉜다.

- **IPv4**는 32비트를 8비트 단위로 점을 찍어 표기하며, 123.45.67.89 같은 방식으로 IP 주소를 나타낸다.
- **IPv6**는 64비트를 16비트 단위로 점을 찍어 표기하며, 2001:db8:ff00:42:8329 같은 방식으로 IP 주소를 나타낸다.

**클래스 기반 할당 방식**

IP 주소의 체계는 처음에는 A, B, C, D, E 다섯 개의 클래스로 구분하는 클래스 기반 할당 방식을 썼다.

앞에 있는 부분을 네트워크 주소, 그 뒤에 있는 부분을 컴퓨터에 부여하는 주소인 호스트 주소로 놓아서 사용한다.

![https://velog.velcdn.com/images/jiyaho/post/417b3cda-4f63-4e88-8823-c46c34577dae/image.svg](https://velog.velcdn.com/images/jiyaho/post/417b3cda-4f63-4e88-8823-c46c34577dae/image.svg)

- 클래스 A, B, C는 일대일 통신으로 사용된다.
- 클래스 D는 멀티캐스트 통신, 클래스 E는 앞으로 사용할 예비용으로 쓰는 방식이다.

클래스 기반 할당 방식은 구체적으로 어떻게 할당될까?

- 만약, 클래스 A로 12.0.0.0이라는 네트워크를 부여 받은 경우,
    - 첫 번째 주소인 12.0.0.0는 네트워크 구별 주소이다.
    - 12.0.0.1 ~ 12.255.255.254까지가 컴퓨터에 부여 가능한 호스트 주소이다.
    - 마지막 주소인 12.255.255.255는 브로드캐스트용 주소이다.
    

그러나 사용하는 주소보다 버리는 주소가 많다는 단점이 있어 클래스 기반 할당 방식을 개선한 **DHCP, IPv6, NAT, CIDR** 등의 방식이 등장했다.

**DHCP(Dynamic Host Configuration Protocol)**

- DHCP(동적 호스트 구성 프로토콜)은 IP 주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜이다.
- 네트워크 장치의 IP 주소를 수동으로 설정할 필요 없이 인터넷에 접속할 때마다 자동으로 IP 주소를 할당할 수 있다.
- 많은 라우터와 게이트웨이 장비에 DHCP 기능이 있으며 이를 통해 대부분의 가정용 네트워크에서 IP 주소를 할당한다.

**NAT(Network Address Translation)**

- 패킷이 라우팅 장비를 통해 전송되는 동안 패킷의 IP 주소 정보를 수정하여 IP 주소를 다른 주소로 매핑하는 방법이다.
- IPv4 주소 체계만으로는 많은 주소들을 모두 감당하지 못하는 단점이 있는데, 이를 해결하기 위해 NAT으로 공인 IP와 사설 IP로 나눠서 많은 주소를 처리한다.
- NAT을 가능하게 하는 소프트웨어는 **ICS, RRAS, Netfilter** 등이 있다.

**공유기와 NAT**

- NAT 사용 목적은 주로 여러 대의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위함이다.
    
    예를 들어 인터넷 회선 하나를 개통하고 인터넷 공유기를 달아서 여러 PC를 연결하여 사용할 수 있는데, 이것이 가능한 이유는 인터넷 공유기에 NAT 기능이 탑재되어 있기 때문이다. 
    

**NAT을 이용한 보안**

- 내부 네트워크에서 사용하는 IP 주소와 외부에 드러나는 IP 주소를 다르게 유지할 수 있기에 내부 네트워크에 대한 어느 정도의 보안이 가능해진다.

**NAT의 단점**

- NAT은 여러 명이 동시에 인터넷 접속하게 되므로 실제로 접속하는 호스트 숫자에 따라서 접속 속도가 느려질 수 있다.

### 2.4.4 IP 주소를 이용한 위치 정보

IP 주소는 인터넷에서 사용하는 네트워크 주소이기 때문에 동 또는 구까지 위치 추적이 가능하다.

## 2.5 HTTP

HTTP는 전송 계층 위에 있는 애플리케이션 계층으로서 웹 서비스 통신에 사용된다.

### 2.5.1 HTTP/1.0

기본적으로 한 연결당 하나의 요청을 처리하도록 설계되었다. 이는 RTT 증가를 불러일으켰다.

**RTT 증가**

> RTT(Round Trip Time, 왕복 시간)란패킷이 목적지에 도달하고 나서 다시 출발지로 돌아오기까지 걸리는 시간이다 (= 패킷 왕복 시간)
> 
- 네트워크 연결의 속도와 안정성을 진단할 때 주로 사용한다.
- RTT에 영향을 주는 요소들
    - 전송 매체의 차이: 무선 혹은 유선 통신
    - 거리의 차이: 근거리, 원거리
    - 서버의 성능
    - 트래픽 양(혼잡도)

서버로부터 파일을 가져올 때 마다 TCP의 3-웨이 핸드셰이크를 계쏙해서 열어야 하기 때문에 RTT가 증가하는 단점이 있었다.

매번 연결할 때마다 RTT가 증가하니 서버에 부담이 많이 가고 사용자 응답 시간이 길어지는 등의 문제가 발생하였다.

**해결 방법**

1. 이미지 스플리팅
    - 이미지 스프라이트(이미지 스플리팅)는 많은 이미지를 다운로드 받게 되면 과부하가 걸리기 때문에 많은 이미지가 합쳐 있는 하나의 이미지를 다운로드 받고, 이를 기반으로 CSS에서 background-image의 position을 이용하여 각각의 이미지를 표기하는 방법이다.
2. 코드 압축
    - 코드를 압축해서 개행 문자, 빈칸을 없애서 코드의 크기를 최소화하는 방법이다.
3. 이미지 Base64 인코딩
    - 이미지 Base64 인코딩은 이미지 파일을 64진법으로 이루어진 문자열로 인코딩하는 방법이다.
    - 이미지 Base64 인코딩의 장점: 서버와의 연결을 열고 이미지에 대해 서버에 HTTP 요청을 할 필요가 없다.
    

❓ 인코딩

정보의 형태나 형식을 표준화, 보안, 처리 속도 향상, 저장 공간 절약 등을 위해 다른 형태나 형식으로 변환하는 처리 방식

### 2.5.2 HTTP/1.1

- HTTP/1.1는 HTTP/1.0에서 발전한 것이다.
- 매번 TCP 연결을 하는 것이 아닌 **1번 TCP를 초기화 한 이후에 keep-alive라는 옵션으로 여러 개의 파일을 송수신**할 수 있게 바뀌었다. (keep-alive는 1.0에서도 있었지만 1.1부터 표준화가 되어 기본 옵션으로 설정 되었다.)
- 한 번 TCP 3-way-handshake가 발생하면 그 다음부터는 발생하지 않는다.
- 문서 안에 포함된 다수의 리소스(이미지, 동영상, css파일, js파일 등)를 처리하려면 **요청할 리소스 개수에 비례하여 대기 시간이 길어진다**.

**HOL Blocking**

네트워크에서 같은 큐에 있는 패킷이 그 첫 번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상을 말한다.

**무거운 헤더 구조**

HTTP/1.1의 헤더에는 쿠키 등 많은 메타데이터가 들어 있고 압축이 되지 않아 무겁다.

### 2.5.3 HTTP/2

HTTP/2는 SPDY 프로토콜에서 파생된 HTTP/1.x보다 지연 시간을 줄이고 응답 시간을 더 빠르게 할 수 있으며 멀티플렉싱, 헤더 압축, 서버 푸시, 요청의 우선순위 처리를 지원하는 프로토콜이다.

**멀티 플렉싱**

- 여러 개의 스트림을 사용하여 송수신하는 것으로 하나의 통신 채널을 통해서 둘 이상의 데이터를 전송하는데 사용되는 기술이다.
- 특정 스트림의 패킷이 손실되었어도 해당 스트림에만 영향을 미치고 나머지 스트림은 정상적으로 동작할 수 있다.

❓스트림(stream)

시간이 지남에 따라 사용할 수 있게 되는 일련의 데이터 요소를 가리키는 데이터 흐름을 말한다.

**헤더 압축**

HTTP/1.x에는 무거운 헤더 구조라는 문제가 있었다. 

HTTP/2에서는 헤더 압축을 써서 해결했는데, 허프만 코딩 압축 알고리즘을 사용하는 HPACK 압축 형식을 가진다.

**허프만 코딩**

문자열을 문자 단위로 쪼개 빈도수를 세어 빈도가 높은 정보는 적은 비트 수를 사용하여 표현하고, 빈도가 낮은 정보는 비트 수를 많이 사용하여 표현해서 전체 데이터의 표현에 필요한 비트양을 줄이는 원리이다.

**서버 푸시**

- HTTP/1.1에서는 클라이언트가 서버에 요청을 해야 파일을 다운로드 받을 수 있었다면, HTTP/2는 클라이언트 요청 없이 서버가 바로 리소스를 푸시할 수 있다.
- HTML에는 css나 js 파일이 포함되기 마련인데 HTML을 읽으면서 그 안에 들어 있던 css파일을 서버에서 푸시하여 클라이언트에 먼저 줄 수 있다.

### 2.5.4 HTTPS

HTTP/2는 HTTPS 위에서 동작한다. 

HTTPS는 애플리케이션 계층과 전송 계층 사이에 신뢰 계층인 SSL/TLS 계층을 넣은 **신뢰할 수 있는 HTTP 요청**을 말한다. 이를 통해 **통신을 암호화**한다.

**SSL/TLS**

- SSL(Secure Socket Layer)은 SSL 1.0부터 시작해서 TLS(Transport Layer Security Protocol)로 명칭이 변경되었으나 보통 이를 합쳐 SSL/TLS로 많이 부른다.
- SSL/TLS는 **전송 계층에서 보안을 제공하는 포로토콜**이다. 클라이언트와 서버가 통신을 할 때 SSL/TLS를 통해 제3자가 메시지를 도청하거나 변조하지 못하도록 한다.
    - 예를 들어 SSL/TLS를 통해 공격자가 서버인 척하며 사용자 정보를 가로채는 네트워크상의 '인터셉터'를 방지할 수 있다.
- SSL/TLS는 보안 세션을 기반으로 데이터를 암호화하며 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 암호화 알고리즘, 해싱 알고리즘이 사용된다.

**보안 세션**

- 보안 세션이란 보안이 시작되고 끝나는 동안 유지되는 세션을 말한다.
- SSL/TLS는 handshake를 통해 보안 세션을 생성하고 이를 기반으로 상태 정보 등을 공유한다.

❓ 세션(session)

세션의 사전적 의미는 (특정 활동을 위한) '시간' 혹은 '기간'으로, 운영체제가 어떠한 사용자로부터 자신의 자산 이용을 허락하는 일정한 기간을 뜻한다. 

즉, 사용자는 일정 시간 동안 응용 프로그램, 자원 등을 사용할 수 있다.

**TLS의 연결 과정과 Handshake**

사용자가 TLS를 사용하는 웹사이트를 접속하면 클라이언트와 웹 서버간에 TLS Handshake가 시작된다.

먼저, 클라이언트는 서버의 인증서를 받아 서버의 무결성을 확인하고 신뢰할 수 있는 서버라면, 암호화 통신에 사용할 대칭키를 서버의 공개키로 암호화 하여 전달한다. 

여기서 데이터를 주고 받기 전, 서버의 무결성을 확인하고 대칭키를 전달하는 과정이 **TLS Handshake**이다.

**서버의 무결성, 신뢰할 수 있는 서버인지 판단하는 기준**

서버가 SSL 인증서(공개키와 서비스의 정보)를 제공하면 브라우저는 해당 인증서를 발급한 CA(Certificate Authorities)가 자신의 CA 리스트에 있는지 확인한다. 

리스트에 존재한다면 CA의 공개키를 이용하여 인증서를 복호화하는데 이러한 과정을 통해 브라우저는 서버의 신원을 확인하고 안전한 연결을 수립한다.

**인증 매커니즘**

- CA(Certificate Authorities)에서 발급한 인증서를 기반으로 이루어진다.
- A에서 발급한 인증서는 안전한 연결을 시작하는 데 있어 필요한 공개키를 클라이언트에게 제공하고 사용자가 접속한 서버가 신뢰할 수 있는 서버임을 보장한다.
- 인증서는 서비스 정보, 공개키, 지문, 디지털 서명 등으로 이루어져 있다.
- CA는 신뢰성이 엄격히 공인된 기업들만 참여할 수 있다. (Amazon, Comodo, GoDaddy, GlobalSign 등)
- CA 발급 과정
    - 특정 서비스가 CA 인증서를 발급받으려면 해당 사이트의 정보와 공개키를 CA에 제출해야 한다.
    - 이후 CA는 공개키를 해시한 값인 지문(finger print)을 사용하는 CA의 비밀키 등을 기반으로 CA 인증서를 발급한다.

**암호화 알고리즘(encryption algorithm)**

키 교환 알고리즘으로는 ECDHE와 DHE가 있는데 둘 다 디피-헬만(Diffie-Hellman) 방식을 근간으로 만들어졌다.

**해싱 알고리즘**

데이터를 **추정하기 힘든 더 작고 섞여 있는 조각으로 만드는 알고리즘**이다.

SSL/TLS는 해싱 알고리즘으로 SHA-256 알고리즘과 SHA-384 알고리즘을 쓰며, 그중 많이 쓰는 것은 SHA-256 알고리즘이다.

**SHA-256 알고리즘**

- SHA-256 알고리즘은 해시 함수의 결괏값이 256비트인 알고리즘으로 비트 코인을 비롯한 많은 블록체인 시스템에서도 쓰인다.
- 해싱을 해야 할 메시지에 1을 추가하는 등 전처리를 하고 전처리된 메시지를 기반으로 해시를 반환한다.

❓ 해시(Hash)

다양한 길이를 가진 데이터를 고정된 길이를 가진 데이터로 mapping한 값을 말한다.

**SEO에도 도움이 되는 HTTPS**

1. **캐노니컬 태그(canonical tag) 설정**
캐노니컬(canonical)의 사전적 의미는 ‘**표준[기준]이 되는**’으로, 캐노니컬 태그는 **한 페이지를 가리키는 여러 개의 주소가 존재할 때**, 검색 엔진의 로봇이 어떤 주소가 원본인지 알 수 있도록 하기 위해 사용하는 태그이다.
2. 메타 설정
3. 페이지 속도 개선
4. 사이트맵 관리

**HTTPS 구축 방법**

- 직접 CA에서 구매한 인증키를 기반으로 HTTPS 서비스를 구축한다.
- 서버 앞단의 HTTPS를 제공하는 로드밸런서를 둬서 구축한다.
- 서버 앞단에 HTTPS를 제공하는 CDN을 둬서 구축한다.

### 2.5.5 HTTP/3

- TCP 위에서 돌아가는 HTTP/2와는 달리 HTTP/3은 QUIC라는 계층 위에서 돌아가며, UDP 기반으로 돌아간다.
- HTTP/2에서 장점이었던 멀티플렉싱을 가지고 있으며, 초기 연결 설정 시 지연 시간 감소라는 장점이 있다.

**초기 연결 설정 시 지연 시간 감소**

- QUIC는 TCP를 사용하지 않기 때문에 통신을 시작할 때 번거로운 3-way handshake 과정을 거치지 않아도 된다.
- QUIC는 첫 연결 설정에 1-RTT(Round Trip Time, 왕복 시간)만 소요된다. 클라이언트가 서버에 어떤 신호를 한 번 주고, 서버도 거기에 응답하기만 하면 바로 본 통신을 시작할 수 있다.
- 참고로 QUIC는 순방향 오류 수정 메커니즘(FEC, Forward Error Correction, 정방향 오류 정정)이 적용되었다. FEC는 전송한 패킷이 손실되었다면 수신 측에서 에러를 검출하고 수정하는 방식이며, 열약한 네트워크 환경에서도 낮은 패킷 손실률을 자랑한다.

**Reference**

[https://change-words.tistory.com/entry/Network-Handshake](https://change-words.tistory.com/entry/Network-Handshake)

[https://hojunking.tistory.com/107](https://hojunking.tistory.com/107)
